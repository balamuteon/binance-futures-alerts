# Binance Futures Alerter (Мониторинг фьючерсов Binance)

Простое приложение на Go для отслеживания изменений цен на фьючерсах Binance (USDⓈ-M) и отправки уведомлений о значительных колебаниях. Уведомления отображаются в консоли и в реальном времени в веб-интерфейсе, с возможностью быстрого перехода к графику монеты на TradingView и звуковым оповещением.

## Основные Возможности

* Подключение к WebSocket потоку `!miniTicker@arr` от Binance Futures для получения данных по всем тикерам в реальном времени.
* Анализ изменения цены каждого тикера по отношению к самой старой цене в скользящем минутном окне.
* Генерация алертов при росте или падении цены выше заданного процентного порога.
* Настраиваемый порог изменения цены и период "затишья" (cooldown) для повторных алертов по одному символу.
* **Уведомления:**
    * Вывод в консоль сервера.
    * Отображение в реальном времени в веб-интерфейсе.
* **Веб-интерфейс:**
    * Список последних алертов.
    * Автоматическое обновление.
    * Кликабельные символы монет в алертах, ведущие на график `СИМВОЛ.P` на TradingView (например, `BINANCE:BTCUSDT.P`).
    * Звуковое оповещение при получении нового алерта (может требовать первоначального взаимодействия пользователя со страницей для активации звука в браузере).
* Поддержка Docker для легкого развертывания.
* Корректное завершение работы (graceful shutdown) по сигналу `Ctrl+C`.
* Модульная структура проекта для лучшей читаемости и поддержки.

## Технологии

* **Бэкенд:** Go
    * `gorilla/websocket` для WebSocket клиента (Binance) и сервера (веб-интерфейс).
    * Стандартная библиотека Go (`net/http`, `encoding/json`, `log`, `time`, `sync` и др.).
* **Фронтенд:** HTML, CSS, JavaScript (ванильный JS, встроенный в HTML).
* **Контейнеризация:** Docker

## Структура Проекта

Проект организован с использованием модульного подхода для разделения ответственности:

* `cmd/futuresalerter/main.go`: Точка входа в приложение, инициализация и связывание компонентов.
* `internal/config/`: Конфигурация приложения.
* `internal/models/`: Определения структур данных (сущности).
* `internal/websocketclient/`: Клиент для подключения к WebSocket Binance.
* `internal/analysis/`: Ядро логики анализа цен и генерации алертов (`PriceProcessor`).
* `internal/alerter/`: Компоненты для отправки уведомлений (в лог, в веб-интерфейс).
* `static/`: Статические файлы для веб-интерфейса (`index.html`, аудиофайл для уведомлений).
* `Dockerfile`: Для сборки Docker-образа.
* `go.mod`, `go.sum`: Управление зависимостями Go.

## Требования

* Go (версия 1.20 или выше рекомендуется) - для локальной разработки и сборки без Docker.
* Docker (версия 20.10 или выше рекомендуется) - для сборки и запуска в Docker-контейнере.
* Веб-браузер для доступа к UI.

## Установка и Настройка

1.  **Клонируйте репозиторий (если он у вас в Git):**
    ```bash
    git clone <URL_вашего_репозитория>
    cd binance-futures-alerter 
    ```
    Или просто убедитесь, что у вас есть все файлы проекта в одной директории.

2.  **Зависимости Go:**
    Для локальной разработки зависимости будут загружены автоматически при сборке или запуске. Если вы хотите загрузить их принудительно:
    ```bash
    go mod tidy
    ```

## Конфигурация

Основные параметры приложения (URL WebSocket Binance, имя потока, порог для алертов, период затишья) на данный момент заданы как константы в коде, преимущественно в:
* `internal/config/config.go`

Для изменения этих параметров отредактируйте соответствующие файлы перед сборкой или запуском.

## Запуск Приложения

### С помощью Go (локально для разработки)

Находясь в **корневой директории** вашего проекта:
<!-- ```bash -->
go run ./cmd/futuresalerter/main.go


### С помощью Docker

Этот метод позволяет упаковать приложение со всеми его зависимостями в портативный Docker-образ, который можно запустить где угодно, где есть Docker.

1.  **Подготовка к сборке:**
    * Убедитесь, что у вас установлен Docker и он запущен.
    * В корне проекта должен находиться файл `Dockerfile` (предоставлен ранее), который описывает шаги сборки.
    * (Опционально, но рекомендуется) В корне проекта может находиться файл `.dockerignore` для исключения ненужных файлов (например, `.git`, локальных логов) из контекста сборки, что ускоряет процесс и уменьшает размер контекста.

2.  **Сборка Docker-образа:**
    Процесс сборки образа Docker происходит на основе инструкций в `Dockerfile`. Он включает в себя несколько этапов (multi-stage build):
    * **Этап сборки ("builder"):**
        * Используется базовый образ Go (`golang:1.24-alpine` в нашем примере).
        * Копируются файлы `go.mod` и `go.sum`, затем загружаются Go-зависимости. Это оптимизировано для использования кеша Docker.
        * Копируется весь остальной исходный код вашего приложения.
        * Приложение компилируется в исполняемый бинарный файл для Linux (`CGO_ENABLED=0 GOOS=linux go build ...`).
    * **Финальный этап:**
        * Используется легковесный базовый образ (`alpine:latest`).
        * Устанавливаются необходимые CA-сертификаты (для HTTPS/WSS).
        * Из этапа "builder" копируется только скомпилированный бинарный файл вашего приложения и папка `static` с веб-файлами. Это позволяет получить очень маленький финальный образ.

    Для сборки образа выполните команду в **корневой директории** проекта:
    ```bash
    docker build -t binance-futures-alerts .
    ```
    * `docker build`: Команда для сборки.
    * `-t binance-futures-alerts`: Присваивает образу имя (тег) `binance-futures-alerts`. Вы можете выбрать любое другое имя.
    * `.`: Указывает, что контекст сборки (все файлы, которые Docker может использовать, с учетом `.dockerignore`) находится в текущей директории.
    Процесс сборки может занять некоторое время, особенно при первом запуске, так как будут загружаться базовые образы и зависимости.

3.  **Запуск Docker-контейнера из собранного образа:**
    После успешной сборки образа, запустите контейнер:
    ```bash
    docker run -p 8080:8080 --rm --name local-binance_alerts binance-futures-alerts
    ```
    * `-p 8080:8080`: Пробрасывает порт 8080 вашего хост-компьютера на порт 8080 внутри контейнера.
    * `--rm`: Автоматически удаляет контейнер после его остановки (удобно для тестов).
    * `--name local-binance_alerts`: Присваивает имя запущенному контейнеру.
    * `binance-futures-alerts`: Имя образа, который вы собрали на предыдущем шаге.
		